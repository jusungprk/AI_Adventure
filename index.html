<!DOCTYPE html>
<html>
<head>
    <title>AI Choose Your Own Adventure</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
    <h1>Welcome, start your adventure by generating your starting point</h1>
    <div id="adventure-image"></div>
    <input type="text" id="adventure-input" placeholder="Enter your starting scenario">
    <button id="generate-btn">Generate</button>
    <div id="choices"></div>
</body>
<script src="script.js">
    let iterationCount = 0;

    const submitButton = document.querySelector("#generate-btn")
    const inputElement = document.querySelector("#adventure-input")
    const imageElement = document.querySelector("#adventure-image")
    const choicesElement = document.querySelector("#choices")

    submitButton.addEventListener("click", async () => {
        let initialPrompt = inputElement.value;
        await processAdventure(initialPrompt);
    });

    async function processAdventure(prompt) {
        const response = await fetch("http://localhost:3000/startAdventure", {
            method: "POST",
            headers: {
            "Content-Type": "application/json"
            },
            body: JSON.stringify({
                prompt: prompt
            })
        });

        const data = await response.json();

        imageElement.src = data.imageUrls[0]; // Adjust this if multiple images are returned
        choicesElement.innerHTML = "";

        for (let choice of data.choices) {
            let choiceElement = document.createElement("div");
            choiceElement.classList.add("choice");
            choiceElement.innerText = choice;
            choiceElement.addEventListener("click", async () => {
                if (iterationCount < 10) {
                    iterationCount++;
                    await processAdventure(choice);
                }
            });
            choicesElement.appendChild(choiceElement);
        }
    }

</script>
</html>
